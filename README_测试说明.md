# OpenHiCKKS æµ‹è¯•è¯´æ˜

## ğŸ“‹ æµ‹è¯•å¥—ä»¶æ¦‚è§ˆ

OpenHiCKKS æä¾›äº†å®Œæ•´çš„æµ‹è¯•å¥—ä»¶ï¼Œåˆ†ä¸º**åŠŸèƒ½æµ‹è¯•**å’Œ**æ€§èƒ½æµ‹è¯•**ä¸¤éƒ¨åˆ†ï¼š

```
test/
â”œâ”€â”€ test_main.c          # åŠŸèƒ½éªŒè¯æµ‹è¯•ç¨‹åº
â”œâ”€â”€ test_benchmark.c     # æ€§èƒ½åŸºå‡†æµ‹è¯•ç¨‹åº
```

---

## ğŸ¯ ä¸¤ç§æµ‹è¯•ç¨‹åº

### 1. åŠŸèƒ½éªŒè¯æµ‹è¯• - test_main

**ç”¨é€”ï¼š** éªŒè¯ CKKS å®ç°çš„æ­£ç¡®æ€§

**è¿è¡Œæ–¹å¼ï¼š**
```bash
cd build
./test_main
```

**æµ‹è¯•å†…å®¹ï¼š**
- âœ… å¤šé¡¹å¼è¿ç®—æ­£ç¡®æ€§ï¼ˆåŠ ã€å‡ã€ä¹˜ã€é™¤ï¼‰
- âœ… ç¼–ç /è§£ç ç²¾åº¦éªŒè¯
- âœ… åŠ å¯†/è§£å¯†æ­£ç¡®æ€§
- âœ… åŒæ€è¿ç®—æ­£ç¡®æ€§
- âœ… å„ç§è¾¹ç•Œæ¡ä»¶æµ‹è¯•

**ç‰¹ç‚¹ï¼š**
- å•æ¬¡è¿è¡ŒéªŒè¯ï¼ˆä¸è¿›è¡Œå¤§é‡è¿­ä»£ï¼‰
- è¾“å‡ºè¯¦ç»†çš„ä¸­é—´ç»“æœ
- åŒ…å«æ–­è¨€å’Œé”™è¯¯æ£€æŸ¥
- è¿è¡Œé€Ÿåº¦å¿«
- é€‚åˆå¼€å‘å’Œè°ƒè¯•é˜¶æ®µ

---

### 2. æ€§èƒ½åŸºå‡†æµ‹è¯• - test_benchmark

**ç”¨é€”ï¼š** è¯„ä¼° CKKS å®ç°çš„æ€§èƒ½æŒ‡æ ‡

**è¿è¡Œæ–¹å¼ï¼š**
```bash
cd build
./test_benchmark
```

**æµ‹è¯•å†…å®¹ï¼š**
- âš¡ å¤šé¡¹å¼è¿ç®—æ€§èƒ½ï¼ˆ10,000æ¬¡è¿­ä»£ï¼‰
- âš¡ ç¼–ç /è§£ç æ€§èƒ½ï¼ˆ10,000æ¬¡è¿­ä»£ï¼‰
- âš¡ åŠ å¯†/è§£å¯†æ€§èƒ½ï¼ˆ1,000æ¬¡è¿­ä»£ï¼‰
- âš¡ åŒæ€è¿ç®—æ€§èƒ½ï¼ˆ10,000æ¬¡è¿­ä»£ï¼‰

**å¤šè§„æ¨¡æµ‹è¯•ï¼š**
- ğŸ“Š è‡ªåŠ¨æµ‹è¯• 4 ä¸ªä¸åŒç»´åº¦ï¼š512, 1024, 2048, 4096
- ğŸ“Š æ¯ä¸ªç»´åº¦è¿è¡Œå®Œæ•´çš„æ€§èƒ½æµ‹è¯•å¥—ä»¶
- ğŸ“Š ä¾¿äºè¯„ä¼°ä¸åŒæ•°æ®è§„æ¨¡ä¸‹çš„æ€§èƒ½è¡¨ç°
- ğŸ“Š ç”Ÿæˆå¯å¯¹æ¯”çš„æ€§èƒ½æ•°æ®

**è¾“å‡ºæŒ‡æ ‡ï¼š**
- æ€»æ‰§è¡Œæ—¶é—´ï¼ˆç§’ï¼‰
- ååé‡ï¼ˆæ“ä½œæ¬¡æ•°/ç§’ï¼‰
- å¹³å‡å»¶è¿Ÿï¼ˆç§’/æ¬¡ï¼‰
- ä¸åŒç»´åº¦çš„æ€§èƒ½å¯¹æ¯”

**ç‰¹ç‚¹ï¼š**
- å¤§é‡è¿­ä»£è·å–å‡†ç¡®æ€§èƒ½æ•°æ®
- æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•
- æ— åŠŸèƒ½éªŒè¯å¼€é”€
- å¤šè§„æ¨¡æµ‹è¯•æ”¯æŒ
- è¿è¡Œæ—¶é—´çº¦ 60-90 ç§’ï¼ˆå–å†³äºç¡¬ä»¶ï¼‰
- é€‚åˆæ€§èƒ½è¯„ä¼°å’Œä¼˜åŒ–å¯¹æ¯”

---

## ğŸ“Š ä½¿ç”¨å»ºè®®

### å¼€å‘é˜¶æ®µ
```bash
# æ¯æ¬¡ä¿®æ”¹ä»£ç åï¼Œå…ˆéªŒè¯åŠŸèƒ½
./test_main
```

### ä¼˜åŒ–é˜¶æ®µ
```bash
# è®°å½•ä¼˜åŒ–å‰çš„æ€§èƒ½
./test_benchmark > before.log

# ä¿®æ”¹ä»£ç è¿›è¡Œä¼˜åŒ–
# ...

# å¯¹æ¯”ä¼˜åŒ–åçš„æ€§èƒ½
./test_benchmark > after.log
diff before.log after.log
```

### å‘å¸ƒå‰éªŒè¯
```bash
# ç¡®ä¿åŠŸèƒ½å’Œæ€§èƒ½éƒ½æ­£å¸¸
./test_main && ./test_benchmark
```

---

## ğŸ”§ ç¼–è¯‘æµ‹è¯•ç¨‹åº

```bash
cd build
cmake ..
make
```

ç¼–è¯‘æˆåŠŸåä¼šç”Ÿæˆï¼š
- `build/test_main` - åŠŸèƒ½æµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶
- `build/test_benchmark` - æ€§èƒ½æµ‹è¯•å¯æ‰§è¡Œæ–‡ä»¶

---

## ğŸ¯ æµ‹è¯•å¯¹æ¯”

| ç‰¹æ€§ | test_main | test_benchmark |
|------|-----------|----------------|
| **ä¸»è¦ç”¨é€”** | åŠŸèƒ½éªŒè¯ | æ€§èƒ½æµ‹è¯• |
| **è¿­ä»£æ¬¡æ•°** | å•æ¬¡ | åƒæ¬¡/ä¸‡æ¬¡ |
| **æµ‹è¯•è§„æ¨¡** | å•ä¸€ç»´åº¦ | 4ä¸ªç»´åº¦ï¼ˆ512-4096ï¼‰ |
| **è¿è¡Œæ—¶é—´** | å¿«ï¼ˆ<1ç§’ï¼‰ | è¾ƒé•¿ï¼ˆ60-90ç§’ï¼‰ |
| **è¾“å‡ºå†…å®¹** | éªŒè¯ç»“æœ+ä¸­é—´æ•°æ® | æ€§èƒ½æŒ‡æ ‡+è§„æ¨¡å¯¹æ¯” |
| **ä½¿ç”¨åœºæ™¯** | å¼€å‘è°ƒè¯• | æ€§èƒ½è¯„ä¼° |
| **ä»£ç ä¿®æ”¹é¢‘ç‡** | è·ŸéšåŠŸèƒ½è¿­ä»£ | ç›¸å¯¹ç¨³å®š |

---

## ğŸ“ˆ å¤šè§„æ¨¡æ€§èƒ½æµ‹è¯•è¯´æ˜

`test_benchmark` ç°åœ¨æ”¯æŒå¤šè§„æ¨¡æµ‹è¯•ï¼Œä¼šè‡ªåŠ¨åœ¨ä»¥ä¸‹ 4 ä¸ªç»´åº¦ä¸‹è¿è¡Œå®Œæ•´æµ‹è¯•ï¼š

| ç»´åº¦ N | æ§½æ•°é‡ | å®‰å…¨çº§åˆ« | é€‚ç”¨åœºæ™¯ |
|--------|--------|----------|----------|
| 512    | 256    | ä½       | å¿«é€ŸåŸå‹éªŒè¯ |
| 1024   | 512    | ä¸­       | ä¸€èˆ¬åº”ç”¨ |
| 2048   | 1024   | é«˜       | å®‰å…¨åº”ç”¨ |
| 4096   | 2048   | å¾ˆé«˜     | é«˜å®‰å…¨è¦æ±‚ |

**è¾“å‡ºç»“æœåŒ…å«ï¼š**
- æ¯ä¸ªç»´åº¦çš„è¯¦ç»†æ€§èƒ½æ•°æ®
- ä¸åŒè§„æ¨¡ä¸‹çš„æ€§èƒ½å¯¹æ¯”
- å¯ç”¨äºåˆ†æç®—æ³•å¤æ‚åº¦

**ç¤ºä¾‹è¾“å‡ºï¼š**
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                ç»´åº¦ N = 1024   çš„æ€§èƒ½æµ‹è¯•                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[æµ‹è¯• 1/4] å¤šé¡¹å¼è¿ç®—æ€§èƒ½æµ‹è¯• (N=1024)...
â±ï¸  å¤šé¡¹å¼åŠ æ³•: 0.123456 ç§’ (81000.00 æ¬¡/ç§’, å¹³å‡ 0.000012 ç§’/æ¬¡)
â±ï¸  å¤šé¡¹å¼ä¹˜æ³•: 1.234567 ç§’ (810.00 æ¬¡/ç§’, å¹³å‡ 0.001235 ç§’/æ¬¡)
...
```

---

## ğŸš€ å¿«é€Ÿå‘½ä»¤

```bash
# å®Œæ•´æµ‹è¯•æµç¨‹
cd build
cmake .. && make           # ç¼–è¯‘
./test_main                # åŠŸèƒ½éªŒè¯
./test_benchmark           # æ€§èƒ½æµ‹è¯•ï¼ˆå¤šè§„æ¨¡ï¼‰

# ä¸€é”®è¿è¡Œå…¨éƒ¨æµ‹è¯•
./test_main && ./test_benchmark && echo "âœ… å…¨éƒ¨æµ‹è¯•é€šè¿‡ï¼"

# ä¿å­˜æ€§èƒ½æµ‹è¯•ç»“æœåˆ°æ–‡ä»¶
./test_benchmark > benchmark_results.txt

# å¯¹æ¯”ä¼˜åŒ–å‰åçš„æ€§èƒ½ï¼ˆå¤šè§„æ¨¡ï¼‰
./test_benchmark > before_multiscale.txt
# ... è¿›è¡Œä»£ç ä¼˜åŒ– ...
./test_benchmark > after_multiscale.txt
diff before_multiscale.txt after_multiscale.txt

# ä½¿ç”¨ä¾¿æ·è„šæœ¬è‡ªåŠ¨ä¿å­˜æµ‹è¯•ç»“æœ
./run_benchmark_multiscale.sh
```

---

## ğŸ”¬ ä¾¿æ·æµ‹è¯•è„šæœ¬

é¡¹ç›®æä¾›äº† `run_benchmark_multiscale.sh` è„šæœ¬æ¥ç®€åŒ–æ€§èƒ½æµ‹è¯•æµç¨‹ï¼š

**åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨æ£€æŸ¥ç¼–è¯‘ç¯å¢ƒ
- âœ… è¿è¡Œå¤šè§„æ¨¡æ€§èƒ½æµ‹è¯•
- âœ… è‡ªåŠ¨ä¿å­˜ç»“æœåˆ° `benchmark_results/` ç›®å½•
- âœ… æ·»åŠ æ—¶é—´æˆ³ä¾¿äºç‰ˆæœ¬å¯¹æ¯”

**ä½¿ç”¨æ–¹æ³•ï¼š**
```bash
# ç›´æ¥è¿è¡Œè„šæœ¬
./run_benchmark_multiscale.sh

# è„šæœ¬ä¼šè‡ªåŠ¨ï¼š
# 1. æ£€æŸ¥ build ç›®å½•å’Œå¯æ‰§è¡Œæ–‡ä»¶
# 2. åˆ›å»º benchmark_results ç›®å½•
# 3. è¿è¡Œæµ‹è¯•å¹¶ä¿å­˜åˆ° benchmark_results/benchmark_YYYYMMDD_HHMMSS.txt
```

